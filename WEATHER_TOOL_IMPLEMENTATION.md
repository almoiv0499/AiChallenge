# Реализация MCP-инструмента для погоды

## Описание

Реализован инструмент `get_weather` для получения текущей погоды и прогноза через Open-Meteo API. Инструмент интегрирован в систему агента через ToolRegistry.

## Структура реализации

### 1. OpenMeteoClient (`src/main/kotlin/org/example/weather/OpenMeteoClient.kt`)

Клиент для работы с Open-Meteo API:
- Получает текущую погоду, почасовой и дневной прогноз
- Использует HTTP-клиент Ktor
- Обрабатывает ошибки и исключения

### 2. Модели данных (`src/main/kotlin/org/example/weather/OpenMeteoModels.kt`)

Модели данных для ответа API:
- `OpenMeteoWeatherResponse` - основной ответ
- `CurrentWeatherData` - текущая погода
- `HourlyForecast` - почасовой прогноз
- `DailyForecast` - дневной прогноз
- `OpenMeteoException` - исключение для ошибок API

### 3. WeatherTool (`src/main/kotlin/org/example/tools/WeatherTool.kt`)

Инструмент агента, реализующий интерфейс `AgentTool`:
- Принимает координаты (широта, долгота)
- Вызывает OpenMeteoClient для получения данных
- Форматирует ответ в читаемый вид
- Преобразует weather code в описания погоды
- Преобразует направление ветра из градусов в стороны света

### 4. Регистрация в ToolRegistry

Инструмент зарегистрирован в `ToolRegistry.createDefault()` в файле `OpenRouterTools.kt`.

## Использование

Инструмент доступен агенту через OpenRouter API. Пример запроса:

```
"Какая погода в Москве? (широта 55.7558, долгота 37.6173)"
```

Агент автоматически вызовет инструмент `get_weather` с соответствующими параметрами.

## Параметры инструмента

- `latitude` (number, обязательный) - широта от -90 до 90
- `longitude` (number, обязательный) - долгота от -180 до 180

## Возвращаемые данные

Инструмент возвращает:
- Текущую погоду (температура, влажность, условия, ветер)
- Прогноз на 7 дней (максимальная/минимальная температура, условия)
- Почасовой прогноз на ближайшие 24 часа (первые 6 часов)

## API

Используется Open-Meteo API: https://api.open-meteo.com/v1/forecast

Документация: https://open-meteo.com/en/docs

## Особенности реализации

1. **Обработка ошибок**: Все ошибки API обрабатываются и возвращаются в понятном виде
2. **Валидация параметров**: Проверка диапазонов координат
3. **Форматирование**: Читаемый формат вывода с эмодзи и структурированными данными
4. **Преобразование кодов**: Weather code преобразуется в описания на русском языке
5. **Направление ветра**: Преобразование из градусов в стороны света (С, Ю, В, З и т.д.)

## Тестирование

Для тестирования инструмента:
1. Запустите приложение
2. Введите запрос с координатами, например: "Какая погода по координатам 55.7558, 37.6173?"
3. Агент автоматически вызовет инструмент и вернет данные о погоде





