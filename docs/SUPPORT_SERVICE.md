# Support Service - ะกะตัะฒะธั ะฟะพะดะดะตัะถะบะธ ั RAG ะธ CRM ะธะฝัะตะณัะฐัะธะตะน

## ะะฑะทะพั

Support Service โ ััะพ ะผะธะฝะธ-ัะตัะฒะธั ะดะปั ะพัะฒะตัะพะฒ ะฝะฐ ะฒะพะฟัะพัั ะฟะพะปัะทะพะฒะฐัะตะปะตะน ะพ ะฟัะพะดัะบัะต. ะะฝ ะพะฑัะตะดะธะฝัะตั:

- **RAG (Retrieval-Augmented Generation)**: ะะพะธัะบ ัะตะปะตะฒะฐะฝัะฝะพะน ะธะฝัะพัะผะฐัะธะธ ะฒ ะดะพะบัะผะตะฝัะฐัะธะธ ะธ FAQ ะดะปั ัะพัะผะธัะพะฒะฐะฝะธั ัะพัะฝัั ะพัะฒะตัะพะฒ
- **MCP (Model Context Protocol)**: ะะฝัะตะณัะฐัะธั ั CRM-ัะธััะตะผะพะน ะดะปั ะฟะพะปััะตะฝะธั ะบะพะฝัะตะบััะฐ ะฟะพะปัะทะพะฒะฐัะตะปั ะธ ะตะณะพ ัะธะบะตัะพะฒ

## ะััะธัะตะบัััะฐ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    Support Assistant                         โ
โ  โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ     โ
โ  โ     RAG     โ    โ     CRM     โ    โ    LLM      โ     โ
โ  โ   Service   โ    โ   Storage   โ    โ  (OpenRouter)โ    โ
โ  โโโโโโโโฌโโโโโโโ    โโโโโโโโฌโโโโโโโ    โโโโโโโโฌโโโโโโโ     โ
โ         โ                  โ                  โ             โ
โ  โโโโโโโโผโโโโโโโ    โโโโโโโโผโโโโโโโ          โ             โ
โ  โ  Document   โ    โ  JSON Data  โ          โ             โ
โ  โ   Index     โ    โ  (Users &   โ          โ             โ
โ  โ  (SQLite)   โ    โ   Tickets)  โ          โ             โ
โ  โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโ          โ             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโ
                                               โ
                     โโโโโโโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโ
                     โ            CRM MCP Server              โ
                     โ  (tools/list, tools/call endpoints)    โ
                     โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## ะะพะผะฟะพะฝะตะฝัั

### 1. CRM Models (`CrmModels.kt`)
ะะพะดะตะปะธ ะดะฐะฝะฝัั ะดะปั CRM-ัะธััะตะผั:
- `User` โ ะฟะพะปัะทะพะฒะฐัะตะปั ั ัะฐัะธัะฝัะผ ะฟะปะฐะฝะพะผ ะธ ัะตะณะฐะผะธ
- `Ticket` โ ัะธะบะตั ะฟะพะดะดะตัะถะบะธ ั ะบะฐัะตะณะพัะธะตะน, ะฟัะธะพัะธัะตัะพะผ ะธ ะธััะพัะธะตะน ัะพะพะฑัะตะฝะธะน
- `TicketMessage` โ ัะพะพะฑัะตะฝะธะต ะฒ ัะฐะผะบะฐั ัะธะบะตัะฐ
- `UserContext` โ ะฟะพะปะฝัะน ะบะพะฝัะตะบัั ะฟะพะปัะทะพะฒะฐัะตะปั ะดะปั ะฐััะธััะตะฝัะฐ

### 2. CRM Storage (`CrmStorage.kt`)
JSON-based ััะฐะฝะธะปะธัะต ั ะดะตะผะพะฝัััะฐัะธะพะฝะฝัะผะธ ะดะฐะฝะฝัะผะธ:
- ะะพะปัะทะพะฒะฐัะตะปะธ (free, pro, enterprise)
- ะขะธะบะตัั ัะฐะทะฝัั ะบะฐัะตะณะพัะธะน (ะฐะฒัะพัะธะทะฐัะธั, ะพะฟะปะฐัะฐ, ัะตัะฝะธัะตัะบะธะต ะฟัะพะฑะปะตะผั)
- ะะพะปะฝะฐั ะธััะพัะธั ะฟะตัะตะฟะธัะบะธ

### 3. CRM MCP Server (`CrmMcpServer.kt`)
MCP-ัะตัะฒะตั ั ะธะฝััััะผะตะฝัะฐะผะธ:
- `crm_get_user_context` โ ะฟะพะปััะธัั ะบะพะฝัะตะบัั ะฟะพะปัะทะพะฒะฐัะตะปั
- `crm_get_ticket` โ ะฟะพะปััะธัั ะธะฝัะพัะผะฐัะธั ะพ ัะธะบะตัะต
- `crm_search_tickets` โ ะฟะพะธัะบ ัะธะบะตัะพะฒ
- `crm_get_ticket_stats` โ ััะฐัะธััะธะบะฐ ะฟะพ ัะธะบะตัะฐะผ
- `crm_update_ticket_status` โ ะธะทะผะตะฝะธัั ััะฐััั ัะธะบะตัะฐ
- `crm_add_ticket_message` โ ะดะพะฑะฐะฒะธัั ัะพะพะฑัะตะฝะธะต ะบ ัะธะบะตัั

### 4. Support Assistant (`SupportAssistant.kt`)
ะะปะฐะฒะฝัะน ะบะพะผะฟะพะฝะตะฝั, ะพะฑัะตะดะธะฝัััะธะน RAG ะธ CRM:
- ะะพะธัะบ ะฒ ะดะพะบัะผะตะฝัะฐัะธะธ ะฟะพ ะทะฐะฟัะพัั
- ะะพะปััะตะฝะธะต ะบะพะฝัะตะบััะฐ ะฟะพะปัะทะพะฒะฐัะตะปั ะธ ัะธะบะตัะฐ
- ะคะพัะผะธัะพะฒะฐะฝะธะต ัะฐััะธัะตะฝะฝะพะณะพ ะฟัะพะผะฟัะฐ ั ะบะพะฝัะตะบััะพะผ
- ะะตะฝะตัะฐัะธั ะฟะตััะพะฝะฐะปะธะทะธัะพะฒะฐะฝะฝะพะณะพ ะพัะฒะตัะฐ

## ะะฐะฟััะบ

### ะัะตะดะฒะฐัะธัะตะปัะฝัะต ััะตะฑะพะฒะฐะฝะธั
```bash
# ะฃััะฐะฝะพะฒะธัะต ะฟะตัะตะผะตะฝะฝัั ะพะบััะถะตะฝะธั ั API ะบะปััะพะผ OpenRouter
export OPENROUTER_API_KEY=your_api_key_here
```

### ะะฐะฟััะบ ัะตัะฒะธัะฐ
```bash
./gradlew runSupportService
```

## ะัะฟะพะปัะทะพะฒะฐะฝะธะต

### ะะตะผะพะฝัััะฐัะธะพะฝะฝัะน ัะตะถะธะผ
ะัะธ ะทะฐะฟััะบะต ัะตัะฒะธั ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฒัะฟะพะปะฝะธั ะฝะตัะบะพะปัะบะพ ะดะตะผะพะฝัััะฐัะธะพะฝะฝัั ััะตะฝะฐัะธะตะฒ:

1. **ะะฑัะธะน ะฒะพะฟัะพั** โ ะฑะตะท ะบะพะฝัะตะบััะฐ ะฟะพะปัะทะพะฒะฐัะตะปั
2. **ะะพะฟัะพั ะพั ะบะพะฝะบัะตัะฝะพะณะพ ะฟะพะปัะทะพะฒะฐัะตะปั** โ ั ััััะพะผ ะตะณะพ ะธััะพัะธะธ
3. **ะะฑัะฐะฑะพัะบะฐ ัะธะบะตัะฐ** โ ะพัะฒะตั ะฝะฐ ะบะพะฝะบัะตัะฝัะน ัะธะบะตั
4. **ะะพะฟัะพั Enterprise ะบะปะธะตะฝัะฐ** โ ะฟัะธะพัะธัะตัะฝะฐั ะฟะพะดะดะตัะถะบะฐ

### ะะฝัะตัะฐะบัะธะฒะฝัะน ัะตะถะธะผ
ะะพัะปะต ะดะตะผะพะฝัััะฐัะธะธ ะดะพัััะฟะตะฝ ะธะฝัะตัะฐะบัะธะฒะฝัะน ัะตะถะธะผ:

```
โ > ะะพัะตะผั ะฝะต ัะฐะฑะพัะฐะตั ะฐะฒัะพัะธะทะฐัะธั?
[ะัะฒะตั ะฐััะธััะตะฝัะฐ...]

โ > user ivan@example.com
โ ะะพะฝัะตะบัั ัััะฐะฝะพะฒะปะตะฝ: ะะฒะฐะฝ ะะตััะพะฒ

โ > ะะพัะตะผั ั ะผะตะฝั ะฝะต ัะฐะฑะพัะฐะตั ะฐะฒัะพัะธะทะฐัะธั ัะตัะตะท Google?
[ะัะฒะตั ั ััััะพะผ ะบะพะฝัะตะบััะฐ ะฟะพะปัะทะพะฒะฐัะตะปั ะธ ะตะณะพ ัะธะบะตัะพะฒ...]

โ > ticket TKT-001
[ะะตัะฐะปัะฝัะน ะพัะฒะตั ะฝะฐ ะบะพะฝะบัะตัะฝัะน ัะธะบะตั...]

โ > stats
[ะกัะฐัะธััะธะบะฐ ะฟะพ ัะธะบะตัะฐะผ...]

โ > exit
```

## ะัะธะผะตั ะพัะฒะตัะฐ ะฐััะธััะตะฝัะฐ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ค ะะขะะะข ะะกะกะะกะขะะะขะ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

ะะดัะฐะฒััะฒัะนัะต, ะะฒะฐะฝ! 

ะะธะถั, ััะพ ั ะฒะฐั ะฒะพะทะฝะธะบะปะฐ ะฟัะพะฑะปะตะผะฐ ั ะฐะฒัะพัะธะทะฐัะธะตะน ัะตัะตะท Google (ะพัะธะฑะบะฐ 
OAUTH_INVALID_TOKEN). ะกัะดั ะฟะพ ะฒะฐัะตะผั ัะธะบะตัั TKT-001, ะฒั ัะถะต ะฟัะพะฑะพะฒะฐะปะธ 
ะพัะธััะธัั cookies, ะฝะพ ััะพ ะฝะต ะฟะพะผะพะณะปะพ.

**ะะตะบะพะผะตะฝะดัั ัะปะตะดัััะธะต ัะฐะณะธ:**

1. ะัะนะดะธัะต ะธะท ะฒัะตั Google ะฐะบะบะฐัะฝัะพะฒ ะฝะฐ accounts.google.com
2. ะะพะฟัะพะฑัะนัะต ะฒะพะนัะธ ะฒ ัะตะถะธะผะต ะธะฝะบะพะณะฝะธัะพ (Chrome: Ctrl+Shift+N)
3. ะัะพะฒะตัััะต, ะฝะต ะฑะปะพะบะธัััั ะปะธ ัะฐััะธัะตะฝะธั ะฑัะฐัะทะตัะฐ ะทะฐะฟัะพัั ะบ Google
4. ะฃะฑะตะดะธัะตัั, ััะพ ัะธััะตะผะฝะพะต ะฒัะตะผั ะฝะฐ ะฒะฐัะตะผ ััััะพะนััะฒะต ะบะพััะตะบัะฝะพ

ะกะพะณะปะฐัะฝะพ ะฝะฐัะตะน ะดะพะบัะผะตะฝัะฐัะธะธ, ะพัะธะฑะบะฐ OAUTH_INVALID_TOKEN ัะฐััะพ ัะฒัะทะฐะฝะฐ 
ั ะบะพะฝัะปะธะบัะพะผ ะผะตะถะดั ะฝะตัะบะพะปัะบะธะผะธ Google ะฐะบะบะฐัะฝัะฐะผะธ ะธะปะธ ะฑะปะพะบะธัะพะฒะบะพะน 
ะทะฐะฟัะพัะพะฒ ะฑัะฐัะทะตัะฝัะผะธ ัะฐััะธัะตะฝะธัะผะธ.

ะะฐะบ VIP-ะบะปะธะตะฝั ะฝะฐ ัะฐัะธัะต Pro, ะฒั ัะฐะบะถะต ะผะพะถะตัะต ะฒะพัะฟะพะปัะทะพะฒะฐัััั 
ะฟัะธะพัะธัะตัะฝะพะน ะฟะพะดะดะตัะถะบะพะน ะฟะพ ัะตะปะตัะพะฝั 8-800-XXX-XX-XX.

ะะพะผะพะณั ะปะธ ั ัะตะผ-ัะพ ะตัั?

๐ ะััะพัะฝะธะบะธ:
  โข docs/support/FAQ.md
  โข docs/support/TROUBLESHOOTING.md

๐ ะขะธะบะตั: TKT-001
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## ะะตะผะพะฝัััะฐัะธะพะฝะฝัะต ะดะฐะฝะฝัะต

### ะะพะปัะทะพะฒะฐัะตะปะธ
| ID | Email | ะะผั | ะขะฐัะธัะฝัะน ะฟะปะฐะฝ | ะขะตะณะธ |
|----|-------|-----|---------------|------|
| user_001 | ivan@example.com | ะะฒะฐะฝ ะะตััะพะฒ | Pro | VIP, frequent_issues |
| user_002 | anna@example.com | ะะฝะฝะฐ ะกะธะดะพัะพะฒะฐ | Enterprise | VIP |
| user_003 | test@example.com | ะขะตััะพะฒัะน ะะพะปัะทะพะฒะฐัะตะปั | Free | new_user |
| user_004 | dmitry@example.com | ะะผะธััะธะน ะะพะทะปะพะฒ | Pro | โ |

### ะขะธะบะตัั
| ID | ะขะตะผะฐ | ะะฐัะตะณะพัะธั | ะกัะฐััั | ะะพะปัะทะพะฒะฐัะตะปั |
|----|------|-----------|--------|--------------|
| TKT-001 | ะะต ัะฐะฑะพัะฐะตั ะฐะฒัะพัะธะทะฐัะธั ัะตัะตะท Google | authorization | open | user_001 |
| TKT-002 | ะะต ะฟัะพัะปะฐ ะพะฟะปะฐัะฐ ะฟะพะดะฟะธัะบะธ | payment | in_progress | user_002 |
| TKT-003 | ะัะธะปะพะถะตะฝะธะต ะฒัะปะตัะฐะตั ะฟัะธ ะพัะบัััะธะธ | technical | waiting_for_customer | user_003 |
| TKT-004 | ะะฐะฑัะป ะฟะฐัะพะปั, ะฝะต ะฟัะธัะพะดะธั ะฟะธััะผะพ | authorization | resolved | user_001 |
| TKT-005 | ะะพะฑะฐะฒััะต ะดะฒัััะฐะบัะพัะฝัั ะฐััะตะฝัะธัะธะบะฐัะธั | feature_request | open | user_004 |
| TKT-006 | ะัะธะฑะบะฐ ัะธะฝััะพะฝะธะทะฐัะธะธ ะดะฐะฝะฝัั | bug_report | in_progress | user_002 |

## ะะฐััะธัะตะฝะธะต

### ะะพะฑะฐะฒะปะตะฝะธะต ะฝะพะฒะพะน ะดะพะบัะผะตะฝัะฐัะธะธ
ะกะพะทะดะฐะนัะต `.md` ัะฐะนะป ะฒ `docs/support/` ะธ ะฟะตัะตะทะฐะฟัััะธัะต ัะตัะฒะธั โ ะพะฝ ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฟัะพะธะฝะดะตะบัะธััะตั ะฝะพะฒัะต ะดะพะบัะผะตะฝัั.

### ะะพะฑะฐะฒะปะตะฝะธะต ะฟะพะปัะทะพะฒะฐัะตะปะตะน/ัะธะบะตัะพะฒ
ะััะตะดะฐะบัะธััะนัะต `support_crm_data.json` ะธะปะธ ะธัะฟะพะปัะทัะนัะต API ัะตัะตะท CRM MCP Server.

### ะะฝัะตะณัะฐัะธั ั ะฒะฝะตัะฝะตะน CRM
ะะตะฐะปะธะทัะนัะต ะธะฝัะตััะตะนั `CrmStorage` ะดะปั ะฟะพะดะบะปััะตะฝะธั ะบ ะฒะฐัะตะน CRM ัะธััะตะผะต (Salesforce, HubSpot, Zendesk ะธ ะดั.)
